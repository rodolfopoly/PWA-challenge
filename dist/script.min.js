let transactions=[],myChart;function populateTotal(){let a=transactions.reduce((a,b)=>a+parseInt(b.value),0);document.querySelector("#total").textContent=a}function populateTable(){let a=document.querySelector("#tbody");a.innerHTML="",transactions.forEach(b=>{let c=document.createElement("tr");c.innerHTML=`
      <td>${b.name}</td>
      <td>${b.value}</td>
    `,a.appendChild(c)})}function populateChart(){let a=transactions.slice().reverse(),e=0,b=a.map(b=>{let a=new Date(b.date);return`${a.getMonth()+1}/${a.getDate()}/${a.getFullYear()}`}),c=a.map(a=>e+=parseInt(a.value));myChart&&myChart.destroy();let d=document.getElementById("myChart").getContext("2d");myChart=new Chart(d,{type:"line",data:{labels:b,datasets:[{label:"Total Over Time",fill:!0,backgroundColor:"#6666ff",data:c}]}})}function sendTransaction(e){let b=document.querySelector("#t-name"),c=document.querySelector("#t-amount"),d=document.querySelector(".form .error");if(""===b.value||""===c.value){d.textContent="Missing Information";return}d.textContent="";let a={name:b.value,value:c.value,date:new Date().toISOString()};e||(a.value*=-1),transactions.unshift(a),populateChart(),populateTable(),populateTotal(),fetch("/api/transaction",{method:"POST",body:JSON.stringify(a),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}}).then(a=>a.json()).then(a=>{a.errors?d.textContent="Missing Information":(b.value="",c.value="")}).catch(d=>{saveRecord(a),b.value="",c.value=""})}fetch("/api/transaction").then(a=>a.json()).then(a=>{transactions=a,populateTotal(),populateTable(),populateChart()}),document.querySelector("#add-btn").onclick=function(){sendTransaction(!0)},document.querySelector("#sub-btn").onclick=function(){sendTransaction(!1)}